<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{% block title %}Shortify{% endblock %}</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Flowbite -->
  <link href="https://unpkg.com/flowbite@1.7.0/dist/flowbite.min.css" rel="stylesheet" />
  <script src="https://unpkg.com/flowbite@1.7.0/dist/flowbite.js"></script>

  <link rel="stylesheet" href="{{ url_for('static', path='css/base.css') }}" />
  <link rel="icon" href="{{ url_for('static', path='img/icon.png') }}" type="image/png" sizes="32x32">
</head>

<body class="overflow-hidden text-gray-800 bg-gray-50 flex flex-col min-h-screen">

  <!-- NAVBAR -->
  <nav class="bg-white border-b border-gray-100 sticky top-0 z-50">
    <div class="max-w-7xl mx-auto flex items-center justify-between px-6 py-3">

      <!-- Left: Logo + Brand -->
      <a href="/" class="flex items-center gap-2">
        <img src="{{ url_for('static', path='img/icon.png') }}" alt="Shortify Logo" class="w-14 h-18">
        <span class="text-2xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 text-transparent bg-clip-text">
          Shortify
        </span>
      </a>

      <!-- Right: Navigation -->
      <div class="flex items-center space-x-6 text-gray-700 font-medium">
        <a href="/" class="hover:text-blue-600 transition">Home</a>
        <a href="/pricing" class="hover:text-blue-600 transition">Pricing</a>
        <a href="/about" class="hover:text-blue-600 transition">About</a>

        {% if user %}
        <!-- Logged-in user menu -->
        <div class="relative group">
          <button class="flex items-center gap-2 focus:outline-none">
            <img src="{{ user.picture }}"
                 alt="User Avatar" class="w-9 h-9 rounded-full border">
            <span class="font-medium text-gray-800">{{ user.name}}</span>
          </button>

          <!-- Dropdown -->
          <div
            class="absolute right-0 mt-2 w-40 bg-white rounded-lg shadow-lg border border-gray-100 opacity-0 group-hover:opacity-100 pointer-events-none group-hover:pointer-events-auto transition">
            <a href="/auth/logou" class="block px-4 py-2 text-sm text-red-500 hover:bg-gray-50">Logout</a>
          </div>
        </div>
        {% else %}
        <!-- Logged-out state -->
        <a href="/login" class="hover:text-blue-600 transition">Login</a>
        <a href="/signup"
          class="bg-gradient-to-r from-blue-500 to-indigo-500 text-white px-4 py-2 rounded-lg hover:opacity-90 transition shadow-sm">
          Sign Up
        </a>
        {% endif %}
      </div>
    </div>
  </nav>

  <!-- MAIN CONTENT -->
  <main class="flex-grow">
    {% block content %}{% endblock %}
  </main>

  <!-- FOOTER -->
  <footer class="bg-gray-900 text-gray-200 py-6">
    <div class="container mx-auto text-center text-sm">
      Built with ❤️ by Sameer | Powered by FastAPI + Upstash Redis
    </div>
  </footer>

  <script>
    // Redirect user to login if not logged in
    async function ensureLogin() {
      const res = await fetch("/auth/me");
      const data = await res.json();
      if (!data.logged_in) window.location.href = "/login";
    }
  </script>

  <script src="{{ url_for('static', path='js/index.js') }}"></script>
</body>

</html>
